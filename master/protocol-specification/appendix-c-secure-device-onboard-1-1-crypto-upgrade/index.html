<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        <meta name="author" content="Secure Device Onboard Contributers">
        <link rel="canonical" href="https://secure-device-onboard.github.io/docs/protocol-specification/appendix-c-secure-device-onboard-1-1-crypto-upgrade/">
        <link rel="shortcut icon" href="../../img/favicon.ico">
        <title>Appendix C - Secure Device Onboard 1.1 Crypto Upgrade - Secure Device Onboard</title>
        <link href="../../css/bootstrap.min.css" rel="stylesheet">
        <link href="../../css/font-awesome.min.css" rel="stylesheet">
        <link href="../../css/base.css" rel="stylesheet">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css">
        <link href="../../css/version-select.css" rel="stylesheet">

        <script src="../../js/jquery-1.10.2.min.js" defer></script>
        <script src="../../js/bootstrap.min.js" defer></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
        <script>hljs.initHighlightingOnLoad();</script> 
    </head>

    <body>
        <div class="navbar fixed-top navbar-expand-lg navbar-dark bg-primary">
            <div class="container">
                <a class="navbar-brand" href="../..">Secure Device Onboard</a>
                <!-- Expander button -->
                <button type="button" class="navbar-toggler" data-toggle="collapse" data-target="#navbar-collapse">
                    <span class="navbar-toggler-icon"></span>
                </button>

                <!-- Expanded navigation -->
                <div id="navbar-collapse" class="navbar-collapse collapse">
                        <!-- Main navigation -->
                        <ul class="nav navbar-nav">
                            <li class="navitem">
                                <a href="../.." class="nav-link">Home</a>
                            </li>
                            <li class="navitem">
                                <a href="../../reference/" class="nav-link">Reference</a>
                            </li>
                            <li class="navitem">
                                <a href="../../community/" class="nav-link">Community</a>
                            </li>
                            <li class="navitem">
                                <a href="../../releases/" class="nav-link">Releases</a>
                            </li>
                            <li class="navitem">
                                <a href="../../security-best-practices/security-best-practices/" class="nav-link">Security Best Practices</a>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">Client SDK <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../../client-sdk/client-sdk-reference-guide/" class="dropdown-item">Introduction</a>
</li>
                                    
<li>
    <a href="../../client-sdk/client-sdk-api-reference/" class="dropdown-item">API Reference</a>
</li>
                                </ul>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">IOT Platform SDK <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../../iot-platform-sdk/introduction/" class="dropdown-item">Introduction</a>
</li>
                                    
<li>
    <a href="../../iot-platform-sdk/running-the-demo/" class="dropdown-item">Running The Demo</a>
</li>
                                    
<li>
    <a href="../../iot-platform-sdk/development-guide/" class="dropdown-item">Development Guide</a>
</li>
                                </ul>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">Rendezvous Service <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../../rendezvous-service/introduction/" class="dropdown-item">Introduction</a>
</li>
                                </ul>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">Supply Chain Tools <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../../supply-chain-tools/manufacturing/manufacturer-enablement-guide/" class="dropdown-item">Manufacturing Tools</a>
</li>
                                    
<li>
    <a href="../../supply-chain-tools/reseller/reseller-enablement-guide/" class="dropdown-item">Reseller Tools</a>
</li>
                                    
<li>
    <a href="../../supply-chain-tools/keystore-guide/" class="dropdown-item">Keystore Guide</a>
</li>
                                </ul>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">Protocol Reference Implementation <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../../protocol-reference-implementation/introduction/" class="dropdown-item">Introduction</a>
</li>
                                </ul>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">All-in-one Demo <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../../all-in-one-demo/introduction/" class="dropdown-item">Introduction</a>
</li>
                                </ul>
                            </li>
                            <li class="dropdown active">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">Protocol Specification <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../introduction/" class="dropdown-item">Introduction</a>
</li>
                                    
<li>
    <a href="../protocol-description/" class="dropdown-item">Protocol Description</a>
</li>
                                    
<li>
    <a href="../protocol-data-types/" class="dropdown-item">Protocol Data Types</a>
</li>
                                    
<li>
    <a href="../data-transmission-persistence/" class="dropdown-item">Data Transmission & Persistence</a>
</li>
                                    
<li>
    <a href="../detailed-protocol-description/" class="dropdown-item">Detailed Protocol Description</a>
</li>
                                    
<li>
    <a href="../resale-protocol/" class="dropdown-item">Resale Protocol</a>
</li>
                                    
<li>
    <a href="../credential-reuse-protocol/" class="dropdown-item">Credential Reuse Protocol</a>
</li>
                                    
<li>
    <a href="../appendix-b-device-provisioning-with-ecdsa/" class="dropdown-item">Appendix B - Device Provisioning with ECDSA</a>
</li>
                                    
<li>
    <a href="./" class="dropdown-item active">Appendix C - Secure Device Onboard 1.1 Crypto Upgrade</a>
</li>
                                </ul>
                            </li>
                        </ul>

                    <ul class="nav navbar-nav ml-auto">
                        <li class="nav-item">
                            <a href="#" class="nav-link" data-toggle="modal" data-target="#mkdocs_search_modal">
                                <i class="fa fa-search"></i> Search
                            </a>
                        </li>
                            <li class="nav-item">
                                <a rel="prev" href="../appendix-b-device-provisioning-with-ecdsa/" class="nav-link">
                                    <i class="fa fa-arrow-left"></i> Previous
                                </a>
                            </li>
                            <li class="nav-item">
                                <a rel="next" class="nav-link disabled">
                                    Next <i class="fa fa-arrow-right"></i>
                                </a>
                            </li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="container">
            <div class="row">
                    <div class="col-md-3"><div class="navbar-light navbar-expand-md bs-sidebar hidden-print affix" role="complementary">
    <div class="navbar-header">
        <button type="button" class="navbar-toggler collapsed" data-toggle="collapse" data-target="#toc-collapse" title="Table of Contents">
            <span class="fa fa-angle-down"></span>
        </button>
    </div>

    
    <div id="toc-collapse" class="navbar-collapse collapse card bg-secondary">
        <ul class="nav flex-column">
            
            <li class="nav-item" data-level="1"><a href="#appendix-c-secure-device-onboard-11-crypto-upgrade" class="nav-link">Appendix C: Secure Device Onboard 1.1 Crypto Upgrade</a>
              <ul class="nav flex-column">
              </ul>
            </li>
        </ul>
    </div>
</div></div>
                    <div class="col-md-9" role="main">

<h1 id="appendix-c-secure-device-onboard-11-crypto-upgrade">Appendix C: Secure Device Onboard 1.1 Crypto Upgrade<a class="headerlink" href="#appendix-c-secure-device-onboard-11-crypto-upgrade" title="Permanent link">&para;</a></h1>
<p>In October of 2017, the Security Architecture Forum (Intel Internal forum)
(SAFE) Crypto Guidelines were upgraded, based on the potential threat of quantum
cryptography. This table indicates crypto levels to apply. Secure Device Onboard 1.0 and Secure Device Onboard 1.1
protocol spec use the left column, and the new crypto strength is given in the
“Future Crypto” column; it will be assigned a Secure Device Onboard release in the
future<em>.</em></p>
<p><em>The length of a release is generally outside the scope of this document;
however, implementers of Secure Device Onboard Service and Owner components must take care
to ensure that Devices using Secure Device Onboard 1.1 crypto must be supported by all Secure Device Onboard components for the life of the Secure Device Onboard 1.1 release.</em></p>
<table>
    <thead>
        <tr>
            <th>Category</th>
            <th>Secure Device Onboard 1.0 &amp; Secure Device Onboard 1.1</th>
            <th>Future Crypto (Enhanced Strength for Quantum Crypto)</th>
            <th>Comments</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>Device HMAC</td>
            <td>HMAC-SHA-256 with HMAC secret of 128 bits</td>
            <td>HMAC-SHA-384 with HMAC secret of 512 bits</td>
            <td>Bay Trail grandfathered for SHA-256 <a href="../protocol-description/#building-the-ownership-credential-ownership-voucher">See §</a></td>
        </tr>
        <tr>
            <td>Hash of Owner Key</td>
            <td>SHA-256</td>
            <td>SHA-384</td>
            <td>(inside Device DI protocol) It is also permissible to store the entire Owner key. <a href="../protocol-description/#building-the-ownership-credential-ownership-voucher">See §</a></td>
        </tr>
        <tr>
            <td>Ownership Voucher (Owner attestation)</td>
            <td>RSA2048 Use RSA2048RESTR as public key type.</td>
            <td>RSA3072, except Bay Trail Use RSA_UR as public key type.</td>
            <td>Bay Trail grandfathered for RSA2048RESTR option. <a href="../protocol-description/#building-the-ownership-credential-ownership-voucher">See §</a></td>
        </tr>
        <tr>
            <td>Ownership Voucher (Owner attestation)</td>
            <td>ECDSA NIST P-256</td>
            <td>ECDSA NIST P-384</td>
            <td>P-384 not supported by some crypto chips; it may be possible to grandfather them in. <a href="../protocol-description/index.html#building-the-ownership-credential-ownership-voucher">See §</a></td>
        </tr>
        <tr>
            <td>Ownership Voucher</td>
            <td>SHA-256</td>
            <td>SHA-384</td>
            <td>Bay Trail grandfathered for SHA-256. <a href="../protocol-description/#building-the-ownership-credential-ownership-voucher">See §</a></td>
        </tr>
        <tr>
            <td>Device attestation EPID1.0, 1.1, 2.0</td>
            <td>Per platform</td>
            <td>No change</td>
            <td>Intel<sup>®</sup> EPID is under evaluation by SAFE; Later versions of Intel<sup>®</sup> EPID are being developed by labs. <a href="../protocol-data-types/#intel-enhanced-privacy-id-intel-epid-signatures-overview">See §</a></td>
        <tr>
            <td>Ownership Voucher</td>
            <td>SHA-256</td>
            <td>SHA-384</td>
            <td>Bay Trail grandfathered for SHA-256. <a href="../protocol-description/#building-the-ownership-credential-ownership-voucher">See §</a></td>
        </tr>
        <tr>
            <td>Device attestation ECDSA</td>
            <td>ECDSA NIST P-256 (with SHA-256 hash) &amp; ECDSA NIST P-384 (with SHA-384 hash)</td>
            <td>ECDSA NIST P-384 (with SHA-384 hash)</td>
            <td>This is the device attestation key built into the device. <a href="../protocol-data-types/#ecdsa-nist-p-256-and-ecdsa-nist-p-384-signatures">See §</a></td>
        </tr>
        <tr>
            <td>Key Exchange, DH</td>
            <td>Id14 (2048-bit modulus) a, b are 256 bits each</td>
            <td>Id15 (3072 bit modulus) a, b are 768 bits each</td>
            <td>New modulus available from same RFC as old, see refs. Increased entropy needed for SVK, SEK. <a href="../protocol-description/index.html#diffie-hellman-key-exchange-protocol">See §</a></td>
        </tr>
        <tr>
            <td>Key Exchange, Asymmetric</td>
            <td>RSA2048RESTR RSA-OAEP-MGF-SHA256 Device, Owner Random of 256 bits</td>
            <td>RSA_UR, 3072 bits RSA-OAEP-MGF-SHA256 Device, Owner Random of 768 bits</td>
            <td>*SHA256* may be used here as mask generation function for RSA-OAEP. Larger D&amp;O Randoms required for SVK, SEK. <a href="../protocol-description/#asymmetric-key-exchange-protocol">See §</a></td>
        </tr>
        <tr>
            <td>Key Exchange, ECDH</td>
            <td>ECC NIST P-256 or NIST P-384, keys used once only Device, Owner random of 128 bits</td>
            <td>ECC NIST P-384, keys used once only Device, Owner random of 384 bits</td>
            <td>Larger D&amp;O Randoms required for SVK, SEK. <a href="../protocol-description/#ecdh-key-exchange-protocol">See §</a></td>
        </tr>
        <tr>
            <td>Key Exchange, ECDH, LEGACY</td>
            <td>ECC NIST P-256, keys used once only Device, Owner random of 128 bits</td>
            <td>ECC NIST P-256, keys used once only Device, Owner random of 512 bits</td>
            <td>Note that this mode can only be used for legacy hardware, with approval from PSE. <a href="../protocol-description/index.html#ecdh-key-exchange-protocol">See §</a></td>
        </tr>
        <tr>
            <td>Key Derivation Function (*‎2.5.5.4*)</td>
            <td>SHA-256 based SEK, SVK entropy is 128 bits (SVK 256 bits, but with lower entropy)</td>
            <td>SHA-384 based SEK is 256 bits SVK is 512 bits</td>
            <td>Note changes to Device and Owner Randoms in key exchange algorithms to support this change. <a href="../protocol-description/index.html#key-derivation-function">See §</a></td>
        </tr>
        <tr>
            <td>SEK (Session Encryption Key)</td>
            <td>128 bits</td>
            <td>256 bits</td>
            <td>Matches TO2 Session Encryption modes. <a href="../protocol-description/#key-exchange-in-the-to2-protocol">See Table in §  </a>; also <a href="../data-transmission-persistence/#encrypted-message-body">see §</a></td>
        </tr>
        <tr>
            <td>SVK (Session Verification Key)</td>
            <td>256 bits, with 128 bits entropy</td>
            <td>512 bits</td>
            <td>Based on 512 bit state of SHA-384. <a href="../protocol-description/#key-exchange-in-the-to2-protocol">See Table in §  </a>; also <a href="../data-transmission-persistence/#encrypted-message-body">see §</a></td>
        </tr>
        <tr>
            <td>TO2 Session HMAC</td>
            <td>HMAC-SHA-256</td>
            <td>HMAC-SHA-384</td>
            <td>HMAC key is 512 bits. <a href="../protocol-description/#key-exchange-in-the-to2-protocol">See Table in §  </a>; also <a href="../data-transmission-persistence/#encrypted-message-body">see §</a></td>.
        </tr>
        <tr>
            <td>TO2 Session Encryption, counter mode</td>
            <td>AES-128/CTR IV 12 bytes, Counter is 4 bytes.</td>
            <td>AES-256/CTR IV is 12 bytes, Counter is 4 bytes</td>
            <td>Note session limits on TO2 protocol (<a href="../detailed-protocol-description/#limitation-of-round-trip-times">See §</a>).</td>
        </tr>
        <tr>
            <td>TO2 Session Encryption, CBC mode</td>
            <td>AES-128/CBC IV is 16 bytes</td>
            <td>AES-256/CBC IV is 16 bytes</td>
            <td>Note session limits on TO2 protocol (<a href="../detailed-protocol-description/#limitation-of-round-trip-times">See §</a>).</td>
        </tr>
        <tr>
            <td>TO2 Protocol Roundtrip Limit</td>
            <td>1M (1e6) rounds</td>
            <td>1M (1e6) rounds</td>
            <td>Required limit for AES/CTR mode. Increased limit is to permit small files to be transmitted in ServiceInfo, esp for MCUs. <a href="../detailed-protocol-description/#transfer-ownership-protocol-2">See §</a></td>
        </tr>
    </tbody>
</table></div>
            </div>
        </div>

        <footer class="col-md-12">
            <hr>
                <p>Copyright &copy; 2020 Intel Corporation - Released under CC BY 4.0 license</p>
            <p>Documentation built with <a href="https://www.mkdocs.org/">MkDocs</a>.</p>
        </footer>
        <script>
            var base_url = "../..",
                shortcuts = {"help": 191, "next": 78, "previous": 80, "search": 83};
        </script>
        <script src="../../js/base.js" defer></script>
        <script src="../../js/version-select.js" defer></script>
        <script src="../../search/main.js" defer></script>

        <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="searchModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="searchModalLabel">Search</h4>
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
            </div>
            <div class="modal-body">
                <p>
                    From here you can search these documents. Enter
                    your search terms below.
                </p>
                <form>
                    <div class="form-group">
                        <input type="search" class="form-control" placeholder="Search..." id="mkdocs-search-query" title="Type search term here">
                    </div>
                </form>
                <div id="mkdocs-search-results"></div>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div><div class="modal" id="mkdocs_keyboard_modal" tabindex="-1" role="dialog" aria-labelledby="keyboardModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="keyboardModalLabel">Keyboard Shortcuts</h4>
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
            </div>
            <div class="modal-body">
              <table class="table">
                <thead>
                  <tr>
                    <th style="width: 20%;">Keys</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td class="help shortcut"><kbd>?</kbd></td>
                    <td>Open this help</td>
                  </tr>
                  <tr>
                    <td class="next shortcut"><kbd>n</kbd></td>
                    <td>Next page</td>
                  </tr>
                  <tr>
                    <td class="prev shortcut"><kbd>p</kbd></td>
                    <td>Previous page</td>
                  </tr>
                  <tr>
                    <td class="search shortcut"><kbd>s</kbd></td>
                    <td>Search</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>

    </body>
</html>
